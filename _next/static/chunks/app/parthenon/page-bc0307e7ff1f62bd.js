(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{1320:function(e,t,s){Promise.resolve().then(s.bind(s,6300))},6300:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(7437),n=s(4131),o=s.n(n),r=s(263).Buffer;let l=(e,t)=>{let s=Math.floor(new Date().getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:s+600,iat:s},n=r.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),l=r.from(JSON.stringify(a)).toString("base64"),c=[n,l].join("."),u=[n,l,o().createSign("RSA-SHA256").update(c).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",u);let d=new XMLHttpRequest;d.open("POST","https://oauth2.googleapis.com/token"),d.onreadystatechange=()=>{4==d.readyState&&200==d.status&&t(JSON.parse(d.responseText).access_token)},d.send(i)},c="RUNNING",u="TERMINATED",i=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),n=new XMLHttpRequest;n.open("GET",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{if(4==n.readyState&&200==n.status){let e=JSON.parse(n.responseText),t={status:e.status,ip:"unknown"};for(let s in e.networkInterfaces)for(let a in e.networkInterfaces[s].accessConfigs)t.ip=e.networkInterfaces[s].accessConfigs[a].natIP;s(t)}},n.send()},d=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()},p=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()};var h=s(6651),g=s.n(h),_=s(5601),m=s.n(_),S=s(6691),f=s.n(S),v=s(2265),y=s(263).Buffer;let b="parthenon_server_data",j={[u]:"OFFLINE",[c]:"ONLINE"},x={[u]:"START",[c]:"STOP"},N=e=>{let{onReceivedServerData:t}=e,[s,n]=(0,v.useState)(""),[o,r]=(0,v.useState)("");return(0,a.jsxs)(v.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:g().serverData,onChange:e=>n(e.target.value)}),(0,a.jsx)("p",{className:g().error,children:o}),(0,a.jsx)("button",{className:g().submit,type:"button",onClick:()=>{try{let e=JSON.parse(y.from(s,"base64").toString());t(e)}catch(e){r("invalid server data")}},children:"ACCESS"})]})},w=()=>{let[e,t]=(0,v.useState)(null),[s,n]=(0,v.useState)(""),[o,r]=(0,v.useState)(null),[h,_]=(0,v.useState)(new Date),m=(null==o?void 0:o.status)===c||(null==o?void 0:o.status)===u,S=(0,v.useCallback)(()=>{""!==s&&null!==e&&i(e,s,e=>{r(e),_(new Date)})},[s,e,r,_]);if((0,v.useEffect)(()=>{let e=localStorage.getItem(b);if(null!==e)try{t(JSON.parse(y.from(e,"base64").toString()))}catch(e){console.error(e),localStorage.removeItem(b)}},[]),(0,v.useEffect)(()=>{null!==e&&l(e,n)},[e]),(0,v.useEffect)(S,[s]),(0,v.useEffect)(()=>{let t=setInterval(()=>{""!==s&&null!==e&&S()},(null==o?void 0:o.status)===c||(null==o?void 0:o.status)===u?1e4:1e3);return()=>clearInterval(t)},[s,e,o]),null===e)return(0,a.jsx)(N,{onReceivedServerData:e=>{localStorage.setItem(b,y.from(JSON.stringify(e)).toString("base64")),t(e)}});let w=[g().submit];return(null==o?void 0:o.status)===c?w.push(g().red):(null==o?void 0:o.status)===u?w.push(g().green):w.push(g().disabled),(0,a.jsxs)(v.Fragment,{children:[(0,a.jsxs)("div",{children:["IP: ",o?o.ip:" "]}),(0,a.jsxs)("div",{className:g().status,children:["STATUS: ",o?j[o.status]||o.status:"Checking status...",(0,a.jsx)("button",{className:"".concat(g().reload," ").concat(m?g().loading:""),type:"button",onClick:S,children:(0,a.jsx)(f(),{alt:"reload",className:"".concat(m?" ":g().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",h.toLocaleDateString()+" "+h.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(w.join(" ")),type:"button",disabled:!m,onClick:()=>{r(null),(null==o?void 0:o.status)===u?d(e,s,S):(null==o?void 0:o.status)===c&&p(e,s,S)},children:o?x[o.status]||o.status:"START"})]})};var T=()=>(0,a.jsxs)("div",{className:g().parthenon,children:[(0,a.jsx)(m(),{children:(0,a.jsx)("title",{children:"Parthenon"})}),(0,a.jsxs)("div",{className:g().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(w,{})]})]})},6651:function(e){e.exports={parthenon:"styles_parthenon__xde_h",box:"styles_box__kjqxB",serverData:"styles_serverData__7I1cn",status:"styles_status__k8UKA",reload:"styles_reload__89KEU",loading:"styles_loading__wDA8M",rotation:"styles_rotation__4Ieur",error:"styles_error__wspBo",submit:"styles_submit__l0l9K",green:"styles_green__0sM_q",red:"styles_red__7bsQL",disabled:"styles_disabled__M837D"}}},function(e){e.O(0,[218,913,807,971,938,744],function(){return e(e.s=1320)}),_N_E=e.O()}]);