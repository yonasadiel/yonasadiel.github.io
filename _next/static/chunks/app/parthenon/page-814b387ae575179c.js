(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{1320:function(e,t,s){Promise.resolve().then(s.bind(s,9881))},9881:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),n=s(5601),o=s.n(n),r=s(2265),l=s(4131),c=s.n(l),u=s(263).Buffer;let i=(e,t)=>{let s=Math.floor(new Date().getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:s+600,iat:s},n=u.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),o=u.from(JSON.stringify(a)).toString("base64"),r=[n,o].join("."),l=[n,o,c().createSign("RSA-SHA256").update(r).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",l);let d=new XMLHttpRequest;d.open("POST","https://oauth2.googleapis.com/token"),d.onreadystatechange=()=>{4==d.readyState&&200==d.status&&t(JSON.parse(d.responseText).access_token)},d.send(i)},d="RUNNING",p="TERMINATED",g=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),n=new XMLHttpRequest;n.open("GET",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{if(4==n.readyState&&200==n.status){let e=JSON.parse(n.responseText),t={status:e.status,ip:"unknown"};for(let s in e.networkInterfaces)for(let a in e.networkInterfaces[s].accessConfigs)t.ip=e.networkInterfaces[s].accessConfigs[a].natIP;s(t)}},n.send()},h=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()},_=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()};var m=s(6651),S=s.n(m),f=s(263).Buffer;let v="parthenon_server_data",y={[p]:"OFFLINE",[d]:"ONLINE"},b={[p]:"START",[d]:"STOP"},j=e=>{let{onReceivedServerData:t}=e,[s,n]=(0,r.useState)(""),[o,l]=(0,r.useState)("");return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:S().serverData,onChange:e=>n(e.target.value)}),(0,a.jsx)("p",{className:S().error,children:o}),(0,a.jsx)("button",{className:S().submit,type:"button",onClick:()=>{try{let e=JSON.parse(f.from(s,"base64").toString());t(e)}catch(e){l("invalid server data")}},children:"ACCESS"})]})},x=()=>{let[e,t]=(0,r.useState)(null),[s,n]=(0,r.useState)(""),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(new Date),m=(null==o?void 0:o.status)===d||(null==o?void 0:o.status)===p,x=(0,r.useCallback)(()=>{""!==s&&null!==e&&g(e,s,e=>{l(e),u(new Date)})},[s,e,l,u]);if((0,r.useEffect)(()=>{let e=localStorage.getItem(v);if(null!==e)try{t(JSON.parse(f.from(e,"base64").toString()))}catch(e){console.error(e),localStorage.removeItem(v)}},[]),(0,r.useEffect)(()=>{null!==e&&i(e,n)},[e]),(0,r.useEffect)(x,[s]),(0,r.useEffect)(()=>{let t=setInterval(()=>{""!==s&&null!==e&&x()},(null==o?void 0:o.status)===d||(null==o?void 0:o.status)===p?1e4:1e3);return()=>clearInterval(t)},[s,e,o]),null===e)return(0,a.jsx)(j,{onReceivedServerData:e=>{localStorage.setItem(v,f.from(JSON.stringify(e)).toString("base64")),t(e)}});let N=[S().submit];return(null==o?void 0:o.status)===d?N.push(S().red):(null==o?void 0:o.status)===p?N.push(S().green):N.push(S().disabled),(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)("div",{children:["IP: ",o?o.ip:" "]}),(0,a.jsxs)("div",{className:S().status,children:["STATUS: ",o?y[o.status]||o.status:"Checking status...",(0,a.jsx)("button",{className:"".concat(S().reload," ").concat(m?S().loading:""),type:"button",onClick:x,children:(0,a.jsx)("img",{className:"".concat(m?" ":S().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",c.toLocaleDateString()+" "+c.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(N.join(" ")),type:"button",disabled:!m,onClick:()=>{l(null),(null==o?void 0:o.status)===p?h(e,s,x):(null==o?void 0:o.status)===d&&_(e,s,x)},children:o?b[o.status]||o.status:"START"})]})};var N=()=>(0,a.jsxs)("div",{className:S().parthenon,children:[(0,a.jsx)(o(),{children:(0,a.jsx)("title",{children:"Parthenon"})}),(0,a.jsxs)("div",{className:S().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(x,{})]})]})},6651:function(e){e.exports={parthenon:"styles_parthenon__xde_h",box:"styles_box__kjqxB",serverData:"styles_serverData__7I1cn",status:"styles_status__k8UKA",reload:"styles_reload__89KEU",loading:"styles_loading__wDA8M",rotation:"styles_rotation__4Ieur",error:"styles_error__wspBo",submit:"styles_submit__l0l9K",green:"styles_green__0sM_q",red:"styles_red__7bsQL",disabled:"styles_disabled__M837D"}}},function(e){e.O(0,[218,64,971,938,744],function(){return e(e.s=1320)}),_N_E=e.O()}]);