(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{1320:function(e,t,s){Promise.resolve().then(s.bind(s,9881))},9881:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(7437),n=s(5601),o=s.n(n),r=s(6691),l=s.n(r),c=s(2265),u=s(4131),i=s.n(u),d=s(263).Buffer;let p=(e,t)=>{let s=Math.floor(new Date().getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:s+600,iat:s},n=d.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),o=d.from(JSON.stringify(a)).toString("base64"),r=[n,o].join("."),l=[n,o,i().createSign("RSA-SHA256").update(r).sign(e.privateKey,"base64")].join("."),c=new FormData;c.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),c.append("assertion",l);let u=new XMLHttpRequest;u.open("POST","https://oauth2.googleapis.com/token"),u.onreadystatechange=()=>{4==u.readyState&&200==u.status&&t(JSON.parse(u.responseText).access_token)},u.send(c)},h="RUNNING",g="TERMINATED",_=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),n=new XMLHttpRequest;n.open("GET",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{if(4==n.readyState&&200==n.status){let e=JSON.parse(n.responseText),t={status:e.status,ip:"unknown"};for(let s in e.networkInterfaces)for(let a in e.networkInterfaces[s].accessConfigs)t.ip=e.networkInterfaces[s].accessConfigs[a].natIP;s(t)}},n.send()},m=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()},S=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()};var f=s(6651),v=s.n(f),y=s(263).Buffer;let b="parthenon_server_data",j={[g]:"OFFLINE",[h]:"ONLINE"},x={[g]:"START",[h]:"STOP"},N=e=>{let{onReceivedServerData:t}=e,[s,n]=(0,c.useState)(""),[o,r]=(0,c.useState)("");return(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:v().serverData,onChange:e=>n(e.target.value)}),(0,a.jsx)("p",{className:v().error,children:o}),(0,a.jsx)("button",{className:v().submit,type:"button",onClick:()=>{try{let e=JSON.parse(y.from(s,"base64").toString());t(e)}catch(e){r("invalid server data")}},children:"ACCESS"})]})},w=()=>{let[e,t]=(0,c.useState)(null),[s,n]=(0,c.useState)(""),[o,r]=(0,c.useState)(null),[u,i]=(0,c.useState)(new Date),d=(null==o?void 0:o.status)===h||(null==o?void 0:o.status)===g,f=(0,c.useCallback)(()=>{""!==s&&null!==e&&_(e,s,e=>{r(e),i(new Date)})},[s,e,r,i]);if((0,c.useEffect)(()=>{let e=localStorage.getItem(b);if(null!==e)try{t(JSON.parse(y.from(e,"base64").toString()))}catch(e){console.error(e),localStorage.removeItem(b)}},[]),(0,c.useEffect)(()=>{null!==e&&p(e,n)},[e]),(0,c.useEffect)(f,[s]),(0,c.useEffect)(()=>{let t=setInterval(()=>{""!==s&&null!==e&&f()},(null==o?void 0:o.status)===h||(null==o?void 0:o.status)===g?1e4:1e3);return()=>clearInterval(t)},[s,e,o]),null===e)return(0,a.jsx)(N,{onReceivedServerData:e=>{localStorage.setItem(b,y.from(JSON.stringify(e)).toString("base64")),t(e)}});let w=[v().submit];return(null==o?void 0:o.status)===h?w.push(v().red):(null==o?void 0:o.status)===g?w.push(v().green):w.push(v().disabled),(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)("div",{children:["IP: ",o?o.ip:" "]}),(0,a.jsxs)("div",{className:v().status,children:["STATUS: ",o?j[o.status]||o.status:"Checking status...",(0,a.jsx)("button",{className:"".concat(v().reload," ").concat(d?v().loading:""),type:"button",onClick:f,children:(0,a.jsx)(l(),{alt:"reload",className:"".concat(d?" ":v().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",u.toLocaleDateString()+" "+u.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(w.join(" ")),type:"button",disabled:!d,onClick:()=>{r(null),(null==o?void 0:o.status)===g?m(e,s,f):(null==o?void 0:o.status)===h&&S(e,s,f)},children:o?x[o.status]||o.status:"START"})]})};var T=()=>(0,a.jsxs)("div",{className:v().parthenon,children:[(0,a.jsx)(o(),{children:(0,a.jsx)("title",{children:"Parthenon"})}),(0,a.jsxs)("div",{className:v().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(w,{})]})]})},6651:function(e){e.exports={parthenon:"styles_parthenon__xde_h",box:"styles_box__kjqxB",serverData:"styles_serverData__7I1cn",status:"styles_status__k8UKA",reload:"styles_reload__89KEU",loading:"styles_loading__wDA8M",rotation:"styles_rotation__4Ieur",error:"styles_error__wspBo",submit:"styles_submit__l0l9K",green:"styles_green__0sM_q",red:"styles_red__7bsQL",disabled:"styles_disabled__M837D"}}},function(e){e.O(0,[218,913,807,971,938,744],function(){return e(e.s=1320)}),_N_E=e.O()}]);