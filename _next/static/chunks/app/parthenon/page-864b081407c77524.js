(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{1320:function(e,t,s){Promise.resolve().then(s.bind(s,9881))},9881:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),n=s(5601),r=s.n(n),o=s(2265),l=s(4131),c=s.n(l),u=s(263).Buffer;let i=(e,t)=>{let s=Math.floor(new Date().getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:s+600,iat:s},n=u.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),r=u.from(JSON.stringify(a)).toString("base64"),o=[n,r].join("."),l=[n,r,c().createSign("RSA-SHA256").update(o).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",l);let d=new XMLHttpRequest;d.open("POST","https://oauth2.googleapis.com/token"),d.onreadystatechange=()=>{4==d.readyState&&200==d.status&&t(JSON.parse(d.responseText).access_token)},d.send(i)},d="RUNNING",p="TERMINATED",f=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),n=new XMLHttpRequest;n.open("GET",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{if(4==n.readyState&&200==n.status){let e=JSON.parse(n.responseText),t={status:e.status,ip:"unknown"};for(let s in e.networkInterfaces)for(let a in e.networkInterfaces[s].accessConfigs)t.ip=e.networkInterfaces[s].accessConfigs[a].natIP;s(t)}},n.send()},_=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()},g=(e,t,s)=>{let a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),n=new XMLHttpRequest;n.open("POST",a),n.setRequestHeader("Authorization","Bearer ".concat(t)),n.onreadystatechange=()=>{4==n.readyState&&200==n.status&&setTimeout(s,1e3)},n.send()};var h=s(6651),m=s.n(h),y=s(263).Buffer;let S="parthenon_server_data",v={[p]:"OFFLINE",[d]:"ONLINE"},b={[p]:"START",[d]:"STOP"},j=e=>{let{onReceivedServerData:t}=e,[s,n]=(0,o.useState)(""),[r,l]=(0,o.useState)("");return(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:m().serverData,onChange:e=>n(e.target.value)}),(0,a.jsx)("p",{className:m().error,children:r}),(0,a.jsx)("button",{className:m().submit,type:"button",onClick:()=>{try{let e=JSON.parse(y.from(s,"base64").toString());t(e)}catch(e){l("invalid server data")}},children:"ACCESS"})]})},x=()=>{let[e,t]=(0,o.useState)(null),[s,n]=(0,o.useState)(""),[r,l]=(0,o.useState)(null),[c,u]=(0,o.useState)(new Date),h=(null==r?void 0:r.status)===d||(null==r?void 0:r.status)===p,x=(0,o.useCallback)(()=>{""!==s&&null!==e&&f(e,s,e=>{l(e),u(new Date)})},[s,e,l,u]);if((0,o.useEffect)(()=>{let e=localStorage.getItem(S);if(null!==e)try{t(JSON.parse(y.from(e,"base64").toString()))}catch(e){console.error(e),localStorage.removeItem(S)}},[]),(0,o.useEffect)(()=>{null!==e&&i(e,n)},[e]),(0,o.useEffect)(x,[s]),(0,o.useEffect)(()=>{let t=setInterval(()=>{""!==s&&null!==e&&x()},(null==r?void 0:r.status)===d||(null==r?void 0:r.status)===p?1e4:1e3);return()=>clearInterval(t)},[s,e,r]),null===e)return(0,a.jsx)(j,{onReceivedServerData:e=>{localStorage.setItem(S,y.from(JSON.stringify(e)).toString("base64")),t(e)}});let N=[m().submit];return(null==r?void 0:r.status)===d?N.push(m().red):(null==r?void 0:r.status)===p?N.push(m().green):N.push(m().disabled),(0,a.jsxs)(o.Fragment,{children:[(0,a.jsxs)("div",{children:["IP: ",r?r.ip:" "]}),(0,a.jsxs)("div",{className:m().status,children:["STATUS: ",r?v[r.status]||r.status:"Checking status...",(0,a.jsx)("button",{className:"".concat(m().reload," ").concat(h?m().loading:""),type:"button",onClick:x,children:(0,a.jsx)("img",{className:"".concat(h?" ":m().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",c.toLocaleDateString()+" "+c.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(N.join(" ")),type:"button",disabled:!h,onClick:()=>{l(null),(null==r?void 0:r.status)===p?_(e,s,x):(null==r?void 0:r.status)===d&&g(e,s,x)},children:r?b[r.status]||r.status:"START"})]})};var N=()=>(0,a.jsxs)("div",{className:m().parthenon,children:[(0,a.jsx)(r(),{children:(0,a.jsx)("title",{children:"Parthenon"})}),(0,a.jsxs)("div",{className:m().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(x,{})]})]})},5601:function(e,t){"use strict";function s(){return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6651:function(e){e.exports={parthenon:"styles_parthenon__xde_h",box:"styles_box__kjqxB",serverData:"styles_serverData__7I1cn",status:"styles_status__k8UKA",reload:"styles_reload__89KEU",loading:"styles_loading__wDA8M",rotation:"styles_rotation__4Ieur",error:"styles_error__wspBo",submit:"styles_submit__l0l9K",green:"styles_green__0sM_q",red:"styles_red__7bsQL",disabled:"styles_disabled__M837D"}},622:function(e,t,s){"use strict";var a=s(2265),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,s){var a,r={},u=null,i=null;for(a in void 0!==s&&(u=""+s),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(i=t.ref),t)o.call(t,a)&&!c.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:n,type:e,key:u,ref:i,props:r,_owner:l.current}}t.Fragment=r,t.jsx=u,t.jsxs=u},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[218,913,971,938,744],function(){return e(e.s=1320)}),_N_E=e.O()}]);