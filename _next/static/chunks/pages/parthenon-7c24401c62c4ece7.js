(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{4621:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/parthenon",function(){return n(9666)}])},9666:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var a=n(5893),o=n(9008),s=n(7294),r=n(8562),c=n.n(r),i=n(2474),u=n.n(i),l=n(1876).Buffer,p="RUNNING",d="TERMINATED",f=n(1876).Buffer;function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v,g,_="parthenon_server_data",m=(h(v={},d,"OFFLINE"),h(v,p,"ONLINE"),v),S=(h(g={},d,"START"),h(g,p,"STOP"),g),j=function(e){var t=e.onReceivedServerData,n=(0,s.useState)(""),o=n[0],r=n[1],i=(0,s.useState)(""),u=i[0],l=i[1];return(0,a.jsxs)(s.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:c().serverData,onChange:function(e){return r(e.target.value)}}),(0,a.jsx)("p",{className:c().error,children:u}),(0,a.jsx)("button",{className:c().submit,type:"button",onClick:function(){try{var e=JSON.parse(f.from(o,"base64").toString());t(e)}catch(n){l("invalid server data")}},children:"ACCESS"})]})},b=function(){var e=(0,s.useState)(null),t=e[0],n=e[1],o=(0,s.useState)(""),r=o[0],i=o[1],h=(0,s.useState)(null),v=h[0],g=h[1],b=(0,s.useState)(new Date),x=b[0],N=b[1],w=(null===v||void 0===v?void 0:v.status)===p||(null===v||void 0===v?void 0:v.status)===d,y=(0,s.useCallback)((function(){""!==r&&null!==t&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),o=new XMLHttpRequest;o.open("GET",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=JSON.parse(o.responseText),t={status:e.status,ip:"unknown"};for(var a in e.networkInterfaces)for(var s in e.networkInterfaces[a].accessConfigs)t.ip=e.networkInterfaces[a].accessConfigs[s].natIP;n(t)}},o.send()}(t,r,(function(e){g(e),N(new Date)}))}),[r,t,g,N]);if((0,s.useEffect)((function(){var e=localStorage.getItem(_);if(null!==e)try{n(JSON.parse(f.from(e,"base64").toString()))}catch(t){console.error(t),localStorage.removeItem(_)}}),[]),(0,s.useEffect)((function(){null!==t&&function(e,t){var n=Math.floor((new Date).getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:n+600,iat:n},o=l.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),s=l.from(JSON.stringify(a)).toString("base64"),r=[o,s].join("."),c=[o,s,u().createSign("RSA-SHA256").update(r).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",c);var p=new XMLHttpRequest;p.open("POST","https://oauth2.googleapis.com/token"),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var e=JSON.parse(p.responseText);t(e.access_token)}},p.send(i)}(t,i)}),[t]),(0,s.useEffect)(y,[r]),(0,s.useEffect)((function(){var e=(null===v||void 0===v?void 0:v.status)===p||(null===v||void 0===v?void 0:v.status)===d?1e4:1e3,n=setInterval((function(){""!==r&&null!==t&&y()}),e);return function(){return clearInterval(n)}}),[r,t,v]),null===t){return(0,a.jsx)(j,{onReceivedServerData:function(e){localStorage.setItem(_,f.from(JSON.stringify(e)).toString("base64")),n(e)}})}var T=[c().submit];return(null===v||void 0===v?void 0:v.status)===p?T.push(c().red):(null===v||void 0===v?void 0:v.status)===d?T.push(c().green):T.push(c().disabled),(0,a.jsxs)(s.Fragment,{children:[(0,a.jsxs)("div",{children:["IP: ",v?v.ip:" "]}),(0,a.jsxs)("div",{className:c().status,children:["STATUS: ",v?m[v.status]||v.status:"Checking status...",(0,a.jsx)("button",{className:"".concat(c().reload," ").concat(w?c().loading:""),type:"button",onClick:y,children:(0,a.jsx)("img",{className:"".concat(w?" ":c().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",x.toLocaleDateString()+" "+x.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(T.join(" ")),type:"button",disabled:!w,onClick:function(){g(null),(null===v||void 0===v?void 0:v.status)===d?function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,r,y):(null===v||void 0===v?void 0:v.status)===p&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,r,y)},children:v?S[v.status]||v.status:"START"})]})},x=function(){return(0,a.jsxs)("div",{className:c().parthenon,children:[(0,a.jsxs)(o.default,{children:[(0,a.jsx)("title",{children:"Parthenon"}),(0,a.jsx)("link",{rel:"icon",type:"image/x-icon",href:"/assets/favicon-32.ico"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),(0,a.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap",rel:"stylesheet"})]}),(0,a.jsxs)("div",{className:c().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(b,{})]})]})}},8562:function(e){e.exports={parthenon:"parthenon_parthenon__lv7Uo",box:"parthenon_box__SV5BW",serverData:"parthenon_serverData__V673G",status:"parthenon_status__XjU_d",reload:"parthenon_reload__JYxVH",loading:"parthenon_loading__Bt7ER",rotation:"parthenon_rotation__w_Ie2",error:"parthenon_error__QmCFT",submit:"parthenon_submit__TK7iD",green:"parthenon_green__Ir78_",red:"parthenon_red__hi7zV",disabled:"parthenon_disabled__OZ4n7"}}},function(e){e.O(0,[714,792,774,888,179],(function(){return t=4621,e(e.s=t);var t}));var t=e.O();_N_E=t}]);