(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{4621:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/parthenon",function(){return n(9666)}])},9666:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var a=n(5893),o=n(9008),r=n(7294),s=n(8562),c=n.n(s),i=n(2474),u=n.n(i),l=n(1876).Buffer,p="RUNNING",d="TERMINATED",h=n(1876).Buffer;function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g,_,m="parthenon_server_data",S=(f(g={},d,"OFFLINE"),f(g,p,"ONLINE"),g),v=(f(_={},d,"START"),f(_,p,"STOP"),_),j=function(e){var t=e.onReceivedServerData,n=(0,r.useState)(""),o=n[0],s=n[1],i=(0,r.useState)(""),u=i[0],l=i[1];return(0,a.jsxs)(r.Fragment,{children:[(0,a.jsx)("label",{children:"Server data"}),(0,a.jsx)("textarea",{className:c().serverData,onChange:function(e){return s(e.target.value)}}),(0,a.jsx)("p",{className:c().error,children:u}),(0,a.jsx)("button",{className:c().submit,type:"button",onClick:function(){try{var e=JSON.parse(h.from(o,"base64").toString());t(e)}catch(n){l("invalid server data")}},children:"ACCESS"})]})},x=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],o=(0,r.useState)(""),s=o[0],i=o[1],h=(0,r.useState)(null),f=h[0],g=h[1],_=(0,r.useState)(new Date),x=_[0],b=_[1],N=f===p||f===d,y=(0,r.useCallback)((function(){""!==s&&null!==t&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),o=new XMLHttpRequest;o.open("GET",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=JSON.parse(o.responseText);n(e.status)}},o.send()}(t,s,(function(e){g(e),b(new Date)}))}),[s,t,g,b]);if((0,r.useEffect)((function(){var e=localStorage.getItem(m);null!==e&&n(JSON.parse(e))}),[]),(0,r.useEffect)((function(){null!==t&&function(e,t){var n=Math.floor((new Date).getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:n+3e3,iat:n},o=l.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),r=l.from(JSON.stringify(a)).toString("base64"),s=[o,r].join("."),c=[o,r,u().createSign("RSA-SHA256").update(s).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",c);var p=new XMLHttpRequest;p.open("POST","https://oauth2.googleapis.com/token"),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var e=JSON.parse(p.responseText);t(e.access_token)}},p.send(i)}(t,i)}),[t]),(0,r.useEffect)(y,[s]),(0,r.useEffect)((function(){var e=setInterval((function(){""!==s&&null!==t&&y()}),f===p||f===d?1e4:1e3);return function(){return clearInterval(e)}}),[s,t,f]),null===t){return(0,a.jsx)(j,{onReceivedServerData:function(e){localStorage.setItem(m,JSON.stringify(e)),n(e)}})}var T=[c().submit];return f===p?T.push(c().red):f===d?T.push(c().green):T.push(c().disabled),(0,a.jsxs)(r.Fragment,{children:[(0,a.jsxs)("div",{className:c().status,children:["STATUS: ",f?S[f]||f:"Checking status...",(0,a.jsx)("button",{className:"".concat(c().reload," ").concat(N?c().loading:""),type:"button",onClick:y,children:(0,a.jsx)("img",{className:"".concat(N?" ":c().loading),src:"/assets/reload.png"})})]}),(0,a.jsxs)("p",{children:["Last updated: ",x.toLocaleDateString()+" "+x.toLocaleTimeString()]}),(0,a.jsx)("button",{className:"".concat(T.join(" ")),type:"button",disabled:!N,onClick:function(){g(null),f===d?function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,s,y):f===p&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,s,y)},children:f?v[f]||f:"START"})]})},b=function(){return(0,a.jsxs)("div",{className:c().parthenon,children:[(0,a.jsxs)(o.default,{children:[(0,a.jsx)("title",{children:"Parthenon"}),(0,a.jsx)("link",{rel:"icon",type:"image/x-icon",href:"/assets/favicon-32.ico"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,a.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),(0,a.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap",rel:"stylesheet"})]}),(0,a.jsxs)("div",{className:c().box,children:[(0,a.jsx)("h1",{children:"Parthenon"}),(0,a.jsx)(x,{})]})]})}},8562:function(e){e.exports={parthenon:"parthenon_parthenon__lv7Uo",box:"parthenon_box__SV5BW",serverData:"parthenon_serverData__V673G",status:"parthenon_status__XjU_d",reload:"parthenon_reload__JYxVH",loading:"parthenon_loading__Bt7ER",rotation:"parthenon_rotation__w_Ie2",error:"parthenon_error__QmCFT",submit:"parthenon_submit__TK7iD",green:"parthenon_green__Ir78_",red:"parthenon_red__hi7zV",disabled:"parthenon_disabled__OZ4n7"}}},function(e){e.O(0,[714,792,774,888,179],(function(){return t=4621,e(e.s=t);var t}));var t=e.O();_N_E=t}]);