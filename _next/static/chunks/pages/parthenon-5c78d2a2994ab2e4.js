(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{4621:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/parthenon",function(){return n(9666)}])},9666:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var a,o=n(5893),s=n(9008),r=n(7294),c=n(602),i=n(8562),u=n.n(i),l=n(2474),p=n.n(l),d=n(1876).Buffer,h="RUNNING",f="TERMINATED",_=n(1876).Buffer;function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m,v=(g(a={},f,"OFFLINE"),g(a,h,"ONLINE"),a),S=(g(m={},f,"START"),g(m,h,"STOP"),m),j=function(e){var t=e.onReceivedServerData,n=(0,r.useState)(""),a=n[0],s=n[1],c=(0,r.useState)(""),i=c[0],l=c[1];return(0,o.jsxs)(r.Fragment,{children:[(0,o.jsx)("label",{children:"Server data"}),(0,o.jsx)("textarea",{className:u().serverData,onChange:function(e){return s(e.target.value)}}),(0,o.jsx)("p",{className:u().error,children:i}),(0,o.jsx)("button",{className:u().submit,type:"button",onClick:function(){try{var e=JSON.parse(_.from(a,"base64").toString());t(e)}catch(n){l("invalid server data")}},children:"ACCESS"})]})},x=function(){var e=(0,r.useState)(null),t=e[0],n=e[1],a=(0,r.useState)(""),s=a[0],i=a[1],l=(0,r.useState)(null),_=l[0],g=l[1],m=(0,r.useState)(new Date),x=m[0],b=m[1],N=(0,r.useCallback)((function(){""!==s&&null!==t&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId),o=new XMLHttpRequest;o.open("GET",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var e=JSON.parse(o.responseText);n(e.status)}},o.send()}(t,s,(function(e){g(e),b(new Date)}))}),[s,t,g,b]);if((0,r.useEffect)((function(){null!==t&&""===s&&function(e,t){var n=Math.floor((new Date).getTime()/1e3),a={iss:e.email,scope:"https://www.googleapis.com/auth/compute",aud:"https://oauth2.googleapis.com/token",exp:n+120,iat:n},o=d.from(JSON.stringify({alg:"RS256",typ:"JWT"})).toString("base64"),s=d.from(JSON.stringify(a)).toString("base64"),r=[o,s].join("."),c=[o,s,p().createSign("RSA-SHA256").update(r).sign(e.privateKey,"base64")].join("."),i=new FormData;i.append("grant_type","urn:ietf:params:oauth:grant-type:jwt-bearer"),i.append("assertion",c);var u=new XMLHttpRequest;u.open("POST","https://oauth2.googleapis.com/token"),u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){var e=JSON.parse(u.responseText);console.log(e.access_token),t(e.access_token)}},u.send(i)}(t,i)}),[t]),(0,r.useEffect)(N,[s]),(0,r.useEffect)((function(){var e=setInterval((function(){""!==s&&null!==t&&N()}),5e3);return function(){return(0,c.clearInterval)(e)}}),[]),null===t)return(0,o.jsx)(j,{onReceivedServerData:n});var T=[u().submit];_===h?T.push(u().red):_===f?T.push(u().green):T.push(u().disabled);var y=_===h||_===f;return(0,o.jsxs)(r.Fragment,{children:[(0,o.jsxs)("div",{className:u().status,children:["STATUS: ",_?v[_]||_:"Checking status...",(0,o.jsx)("button",{className:"".concat(u().reload," ").concat(y?u().loading:""),type:"button",onClick:N,children:(0,o.jsx)("img",{className:"".concat(y?" ":u().loading),src:"/assets/reload.png"})})]}),(0,o.jsxs)("p",{children:["Last updated: ",x.toLocaleDateString()+" "+x.toLocaleTimeString()]}),(0,o.jsx)("button",{className:"".concat(T.join(" ")),type:"button",disabled:!y,onClick:function(){g(null),_===f?function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/start"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,s,N):_===h&&function(e,t,n){var a="https://compute.googleapis.com/compute/v1/projects/".concat(e.project,"/zones/").concat(e.zone,"/instances/").concat(e.resourceId,"/stop"),o=new XMLHttpRequest;o.open("POST",a),o.setRequestHeader("Authorization","Bearer ".concat(t)),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&setTimeout(n,1e3)},o.send()}(t,s,N)},children:_?S[_]||_:"START"})]})},b=function(){return(0,o.jsxs)("div",{className:u().parthenon,children:[(0,o.jsxs)(s.default,{children:[(0,o.jsx)("title",{children:"Parthenon"}),(0,o.jsx)("link",{rel:"icon",type:"image/x-icon",href:"/assets/favicon-32.ico"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),(0,o.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap",rel:"stylesheet"})]}),(0,o.jsxs)("div",{className:u().box,children:[(0,o.jsx)("h1",{children:"Parthenon"}),(0,o.jsx)(x,{})]})]})}},8562:function(e){e.exports={parthenon:"parthenon_parthenon__lv7Uo",box:"parthenon_box__SV5BW",serverData:"parthenon_serverData__V673G",status:"parthenon_status__XjU_d",reload:"parthenon_reload__JYxVH",loading:"parthenon_loading__Bt7ER",rotation:"parthenon_rotation__w_Ie2",error:"parthenon_error__QmCFT",submit:"parthenon_submit__TK7iD",green:"parthenon_green__Ir78_",red:"parthenon_red__hi7zV",disabled:"parthenon_disabled__OZ4n7"}}},function(e){e.O(0,[714,799,774,888,179],(function(){return t=4621,e(e.s=t);var t}));var t=e.O();_N_E=t}]);